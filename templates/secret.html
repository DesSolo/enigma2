{% extends "base.html" %}

{% block styles %}
<style>
    .message-textarea {
        width: 100%;
        min-height: 150px;
        padding: 15px;
        font-size: 16px;
        color: var(--dark);
        background-color: var(--light);
        border: 2px solid var(--border);
        border-radius: 10px;
        resize: vertical;
        transition: all 0.3s ease;
        min-height: 200px;
        font-family: inherit;
    }

    .message-textarea:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .header-container {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        margin-bottom: 25px;
        position: relative;
    }

    .header-container h1 {
        margin: 0;
    }

    .help-container {
        position: relative;
        display: flex;
        align-items: center;
    }

    .help-icon {
        width: 20px;
        height: 20px;
        fill: var(--primary);
        cursor: help;
        vertical-align: middle;
        margin-left: 5px;
    }

    .help-tooltip {
        position: absolute;
        bottom: 100%;
        right: 0;
        background: #333;
        color: white;
        padding: 10px;
        border-radius: 6px;
        font-size: 13px;
        width: 250px;
        z-index: 10;
        margin-bottom: 5px;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
    }

    .help-container:hover .help-tooltip {
        opacity: 1;
        visibility: visible;
    }

    .message-container {
        margin: 25px 0;
        position: relative;
    }

    .btn-group {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
        margin-top: 20px;
    }

    @media (max-width: 600px) {
        .message-textarea {
            font-size: 15px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="header-container">
        <h1>Your secure message is shown below.</h1>
        <div class="help-container">
            <svg class="help-icon" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"></path>
            </svg>
            <div class="help-tooltip">
                This message will be permanently deleted after you leave this page.
                It can only be accessed once.
            </div>
        </div>
    </div>

    <div class="message-container">
        <textarea class="message-textarea" readonly>{{ secret }}</textarea>
    </div>

    <div class="btn-group">
        <button class="btn" id="copyButton">
            <svg viewBox="0 0 24 24" width="20" height="20">
                <path d="M16 1H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11l4 4V3c0-1.1-.9-2-2-2zM16 19H5V5h11v14z"></path>
            </svg>
            <span class="btn-text">Copy Message</span>
        </button>
    </div>
</div>

<script>
    const copyButton = document.getElementById('copyButton');
    const buttonText = copyButton.querySelector('.btn-text');
    const originalButtonText = buttonText.textContent;

    copyButton.addEventListener('click', () => {
        const textarea = document.querySelector('.message-textarea');
        navigator.clipboard.writeText(textarea.value)
            .then(() => {
                buttonText.textContent = ' Copied!';
                setTimeout(() => {
                    buttonText.textContent = originalButtonText;
                }, 2000);
            })
            .catch(err => {
                alert('Failed to copy message. Please try again.');
                console.error('Copy failed:', err);
            });
    });

    // Auto-select text when clicking on textarea
    document.querySelector('.message-textarea').addEventListener('click', function() {
        this.select();
    });
</script>
{% endblock %}